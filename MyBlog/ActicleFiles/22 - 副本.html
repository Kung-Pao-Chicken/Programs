<p>它的代码帮了我大忙，十分感谢！</p><p><br/></p><p><span style="color:#FF6600">核心：手柄信号采样类申明及实现</span></p><div class="dp-highlighter bg_plain"><span><span>Public&nbsp;Class&nbsp;PlayJoyControl&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;Const&nbsp;JOY_RETURNBUTTONS&nbsp;=&nbsp;&amp;H80&amp;&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;Structure&nbsp;JOYINFOEX&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;dwSize&nbsp;As&nbsp;Integer&nbsp;&nbsp;&nbsp;&#39;size&nbsp;of&nbsp;structure</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;dwFlags&nbsp;As&nbsp;Integer&nbsp;&nbsp;&nbsp;&#39;flags&nbsp;to&nbsp;indicate&nbsp;what&nbsp;to&nbsp;return&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;wXpos&nbsp;As&nbsp;Integer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;&nbsp;&nbsp;x&nbsp;position&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;wYpos&nbsp;As&nbsp;Integer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;&nbsp;&nbsp;y&nbsp;position&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;wZpos&nbsp;As&nbsp;Integer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;&nbsp;&nbsp;z&nbsp;position&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;wRpos&nbsp;As&nbsp;Integer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;&nbsp;&nbsp;rudder/4th&nbsp;axis&nbsp;position&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;wUpos&nbsp;As&nbsp;Integer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;&nbsp;&nbsp;5th&nbsp;axis&nbsp;position&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;wVpos&nbsp;As&nbsp;Integer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;&nbsp;&nbsp;6th&nbsp;axis&nbsp;position&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;wButtons&nbsp;As&nbsp;Integer&nbsp;&#39;&nbsp;&nbsp;button&nbsp;states&nbsp;&nbsp;&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;wButtonNumber&nbsp;As&nbsp;Integer&nbsp;&nbsp;&nbsp;&nbsp;&#39;&nbsp;&nbsp;current&nbsp;button&nbsp;number&nbsp;pressed&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;dwPOV&nbsp;As&nbsp;Integer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;&nbsp;&nbsp;point&nbsp;of&nbsp;view&nbsp;state&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;dwReserved1&nbsp;As&nbsp;Integer&nbsp;&nbsp;&nbsp;&#39;&nbsp;&nbsp;reserved&nbsp;for&nbsp;communication&nbsp;between&nbsp;winmm&nbsp;driver&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;dwReserved2&nbsp;As&nbsp;Integer&nbsp;&nbsp;&#39;&nbsp;&nbsp;reserved&nbsp;for&nbsp;future&nbsp;expansion&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;DeviceState&nbsp;As&nbsp;String&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Structure&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Private&nbsp;Declare&nbsp;Function&nbsp;joyGetPosEx&nbsp;Lib&nbsp;&quot;winmm.dll&quot;&nbsp;(ByVal&nbsp;uJoyID&nbsp;As&nbsp;Integer,&nbsp;ByRef&nbsp;jInfo&nbsp;As&nbsp;JOYINFOEX)&nbsp;As&nbsp;Integer&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;Declare&nbsp;Function&nbsp;joySetCapture&nbsp;Lib&nbsp;&quot;winmm.dll&quot;&nbsp;(ByVal&nbsp;hwnd&nbsp;As&nbsp;IntPtr,&nbsp;ByVal&nbsp;uID&nbsp;As&nbsp;Integer,&nbsp;ByVal&nbsp;uPeriod&nbsp;As&nbsp;Integer,&nbsp;ByVal&nbsp;bChanged&nbsp;As&nbsp;Boolean)&nbsp;As&nbsp;Long&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;Declare&nbsp;Function&nbsp;joyReleaseCapture&nbsp;Lib&nbsp;&quot;winmm.dll&quot;&nbsp;(ByVal&nbsp;id&nbsp;As&nbsp;Long)&nbsp;As&nbsp;Long&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;Shared&nbsp;Function&nbsp;PlayJoyState()&nbsp;As&nbsp;JOYINFOEX&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;infoJEx&nbsp;As&nbsp;JOYINFOEX&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;With&nbsp;infoJEx&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.dwSize&nbsp;=&nbsp;Marshal.SizeOf(GetType(JOYINFOEX))&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.dwFlags&nbsp;=&nbsp;CInt(JOY_RETURNBUTTONS)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.DeviceState&nbsp;=&nbsp;&quot;OK&quot;&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;With&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;result&nbsp;As&nbsp;Integer&nbsp;=&nbsp;joyGetPosEx(False,&nbsp;infoJEx)&nbsp;&nbsp;&nbsp;&nbsp;&#39;返回JOYERR_NOERROR(值为0)&nbsp;&nbsp;&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;MsgBox(res)&nbsp;&nbsp;&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;result&nbsp;=&nbsp;0&nbsp;Then&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;获取成功，输出原始数据&nbsp;&nbsp;&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return&nbsp;infoJEx&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;infoJEx.DeviceState&nbsp;=&nbsp;&quot;ERROR&quot;&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return&nbsp;infoJEx&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;If&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Function&nbsp;&nbsp;</span><br/><span>End&nbsp;Class&nbsp;&nbsp;</span></div><p><br/><br/></p><p><span style="color:#FF6600">1.按键代码申明</span></p><div class="dp-highlighter bg_vb"><span><span class="keyword">Public</span><span>&nbsp;</span><span class="keyword">Enum</span><span>&nbsp;JoyButton&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Integer</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;=&nbsp;1&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;B&nbsp;=&nbsp;2&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;X&nbsp;=&nbsp;4&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Y&nbsp;=&nbsp;8&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;LB&nbsp;=&nbsp;16&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;RB&nbsp;=&nbsp;32&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Back&nbsp;=&nbsp;64&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Start&nbsp;=&nbsp;128&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Up&nbsp;=&nbsp;0&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Down&nbsp;=&nbsp;18000&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Left&nbsp;=&nbsp;27000&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Right&nbsp;=&nbsp;9000&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;LPad&nbsp;=&nbsp;&amp;H100&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;RPad&nbsp;=&nbsp;512&nbsp;&nbsp;</span><br/><span><span class="keyword">End</span><span>&nbsp;</span><span class="keyword">Enum</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;</span><br/><span><span class="keyword">Public</span><span>&nbsp;</span><span class="keyword">Enum</span><span>&nbsp;JoyKeyActive&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Integer</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Click&nbsp;=&nbsp;0&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Down&nbsp;=&nbsp;1&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Up&nbsp;=&nbsp;2&nbsp;&nbsp;</span><br/><span><span class="keyword">End</span><span>&nbsp;</span><span class="keyword">Enum</span><span>&nbsp;&nbsp;</span></span></div><p><span style="color:#FF6600">2.事件手柄按键事件声明</span></p><div class="dp-highlighter bg_vb"><span><span class="keyword">Public</span><span>&nbsp;</span><span class="keyword">Class</span><span>&nbsp;JoyKeysEventArgs&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Inherits</span><span>&nbsp;EventArgs&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Private</span><span>&nbsp;_JoyButton&nbsp;</span><span class="keyword">As</span><span>&nbsp;JoyButton&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Private</span><span>&nbsp;_Active&nbsp;</span><span class="keyword">As</span><span>&nbsp;JoyKeyActive&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Public</span><span>&nbsp;</span><span class="keyword">Sub</span><span>&nbsp;</span><span class="keyword">New</span><span>(</span><span class="keyword">ByVal</span><span>&nbsp;JoyButton&nbsp;</span><span class="keyword">As</span><span>&nbsp;JoyButton,&nbsp;</span><span class="keyword">ByVal</span><span>&nbsp;Active&nbsp;</span><span class="keyword">As</span><span>&nbsp;JoyKeyActive)&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_JoyButton&nbsp;=&nbsp;JoyButton&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_Active&nbsp;=&nbsp;Active&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">End</span><span>&nbsp;</span><span class="keyword">Sub</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Public</span><span>&nbsp;</span><span class="keyword">ReadOnly</span><span>&nbsp;</span><span class="keyword">Property</span><span>&nbsp;JoyButton&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Get</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Return</span><span>&nbsp;_JoyButton&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">End</span><span>&nbsp;</span><span class="keyword">Get</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">End</span><span>&nbsp;</span><span class="keyword">Property</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Public</span><span>&nbsp;</span><span class="keyword">ReadOnly</span><span>&nbsp;</span><span class="keyword">Property</span><span>&nbsp;Active&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Get</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Return</span><span>&nbsp;_Active&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">End</span><span>&nbsp;</span><span class="keyword">Get</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">End</span><span>&nbsp;</span><span class="keyword">Property</span><span>&nbsp;&nbsp;</span></span><br/><span><span class="keyword">End</span><span>&nbsp;</span><span class="keyword">Class</span><span>&nbsp;&nbsp;</span></span></div><p><span style="color:#FF6600">3.手柄摇杆事件申明</span></p><div class="dp-highlighter bg_plain"><span><span>Public&nbsp;Class&nbsp;JoyPadsWheelEventArgs&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Inherits&nbsp;EventArgs&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Private&nbsp;_JoyPad&nbsp;As&nbsp;JoyButton&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Private&nbsp;_XValue&nbsp;As&nbsp;Integer&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Private&nbsp;_YValue&nbsp;As&nbsp;Integer&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Private&nbsp;_SpeedWeight&nbsp;As&nbsp;Integer&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;Sub&nbsp;New(ByVal&nbsp;JoyButton&nbsp;As&nbsp;JoyButton,&nbsp;ByVal&nbsp;XValue&nbsp;As&nbsp;Integer,&nbsp;ByVal&nbsp;YValue&nbsp;As&nbsp;Integer,&nbsp;Optional&nbsp;ByVal&nbsp;SpeedWeight&nbsp;As&nbsp;Integer&nbsp;=&nbsp;4000)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_XValue&nbsp;=&nbsp;XValue&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_YValue&nbsp;=&nbsp;YValue&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_JoyPad&nbsp;=&nbsp;JoyButton&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_SpeedWeight&nbsp;=&nbsp;SpeedWeight&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Sub&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;ReadOnly&nbsp;Property&nbsp;joybuttons&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return&nbsp;_JoyPad&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Get&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Property&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;ReadOnly&nbsp;Property&nbsp;XValue&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return&nbsp;_XValue&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Get&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Property&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;ReadOnly&nbsp;Property&nbsp;YValue&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return&nbsp;_YValue&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Get&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Property&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;Property&nbsp;SpeedWeight&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return&nbsp;_SpeedWeight&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Get&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set(value)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_SpeedWeight&nbsp;=&nbsp;value&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Set&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Property&nbsp;&nbsp;</span><br/><span>End&nbsp;Class&nbsp;&nbsp;</span></div><p><span style="color:#FF6600">4.手柄事件类申明及实现</span></p><div class="dp-highlighter bg_plain"><span><span>Public&nbsp;Class&nbsp;JoyKeysEvent&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;Shared&nbsp;Sub&nbsp;JoyKeysAction(ByVal&nbsp;e&nbsp;As&nbsp;JoyKeysEventArgs)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;Case&nbsp;e.Active&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;JoyKeyActive.Click&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;Case&nbsp;e.JoyButton&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;JoyButton.A&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MouseControl.MouseButtonClick(MouseControl.MOUSEEVENTF_RIGHTDOWN,&nbsp;MouseControl.MOUSEEVENTF_RIGHTUP,&nbsp;200)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;JoyButton.B&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MouseControl.MouseButtonClick(MouseControl.MOUSEEVENTF_LEFTDOWN,&nbsp;MouseControl.MOUSEEVENTF_LEFTUP,&nbsp;10)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;JoyButton.X&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeyBoardControl.EnterKeyPress(&amp;H8,&nbsp;0)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;JoyButton.Y&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeyBoardControl.EnterKeyPress(KeyBoardControl.ENTER,&nbsp;200)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;JoyButton.LB&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeyBoardControl.EnterKeyPress(KeyBoardControl.PAGEP,&nbsp;200)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;JoyButton.RB&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeyBoardControl.EnterKeyPress(KeyBoardControl.PAGEN,&nbsp;200)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;JoyButton.Start&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeyBoardControl.EnterKeyPress(KeyBoardControl.REFRESH,&nbsp;200)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;JoyButton.RPad&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MouseControl.MouseButtonClick(MouseControl.MOUSEEVENTF_MIDDLEDOWN,&nbsp;MouseControl.MOUSEEVENTF_MIDDLEUP,&nbsp;200)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;JoyButton.Up&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeyBoardControl.EnterKeyPress(&amp;H26,&nbsp;200)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;JoyButton.Down&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeyBoardControl.EnterKeyPress(&amp;H28,&nbsp;200)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;JoyButton.Left&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeyBoardControl.EnterKeyPress(&amp;H25,&nbsp;200)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;JoyButton.Right&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeyBoardControl.EnterKeyPress(&amp;H27,&nbsp;200)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Select&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;JoyKeyActive.Down&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;Case&nbsp;e.JoyButton&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;JoyButton.B&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MouseControl.MouseButtonDown(MouseControl.MOUSEEVENTF_LEFTDOWN)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;JoyButton.X&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeyBoardControl.EnterKeyDown(&amp;H8)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Select&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;JoyKeyActive.Up&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;Case&nbsp;e.JoyButton&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;JoyButton.B&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MouseControl.MouseButtonUp(MouseControl.MOUSEEVENTF_LEFTUP)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;JoyButton.X&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeyBoardControl.EnterKeyUp(&amp;H8)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MouseControl.MouseButtonUp(MouseControl.MOUSEEVENTF_LEFTUP)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Select&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Select&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Sub&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;Shared&nbsp;Sub&nbsp;JoyPadWheel(ByVal&nbsp;e&nbsp;As&nbsp;JoyPadsWheelEventArgs)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;Case&nbsp;e.joybuttons&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;JoyButton.RPad&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select&nbsp;Case&nbsp;e.XValue&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;65535&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeyBoardControl.EnterKeyPress(&amp;H22,&nbsp;200)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;MouseControl.MouseMiddleButtonRow(&quot;up&quot;,&nbsp;1,&nbsp;2)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;0&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeyBoardControl.EnterKeyPress(&amp;H21,&nbsp;200)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;MouseControl.MouseMiddleButtonRow(&quot;down&quot;,&nbsp;1,&nbsp;2)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Select&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Case&nbsp;JoyButton.LPad&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;Not&nbsp;(e.XValue&nbsp;=&nbsp;32767&nbsp;And&nbsp;e.YValue&nbsp;=&nbsp;32766)&nbsp;Then&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim&nbsp;mousepoint&nbsp;As&nbsp;New&nbsp;MouseControl.MousePoint&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MouseControl.GetCursorPos(mousepoint)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MouseControl.SetCursorPos(mousepoint.x&nbsp;-&nbsp;(32767&nbsp;-&nbsp;e.XValue)&nbsp;/&nbsp;e.SpeedWeight,&nbsp;mousepoint.y&nbsp;-&nbsp;(32767&nbsp;-&nbsp;e.YValue)&nbsp;/&nbsp;e.SpeedWeight)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Threading.Thread.Sleep(10)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;If&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Select&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Sub&nbsp;&nbsp;</span><br/><span>End&nbsp;Class&nbsp;&nbsp;</span></div><p><span style="color:#FF6600">5.键盘按键模拟类申明</span></p><div class="dp-highlighter bg_plain"><span><span>Public&nbsp;Class&nbsp;KeyBoardControl&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;Const&nbsp;ENTER&nbsp;=&nbsp;&amp;HD&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;Const&nbsp;PAGEP&nbsp;=&nbsp;&amp;HA6&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;Const&nbsp;PAGEN&nbsp;=&nbsp;&amp;HA7&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;Const&nbsp;REFRESH&nbsp;=&nbsp;&amp;HA8&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;DllImport(&quot;user32.dll&quot;,&nbsp;CallingConvention:=CallingConvention.StdCall,&nbsp;CharSet:=CharSet.Unicode,&nbsp;EntryPoint:=&quot;keybd_event&quot;,&nbsp;ExactSpelling:=True,&nbsp;SetLastError:=True)&gt;&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Private&nbsp;Shared&nbsp;Sub&nbsp;keybd_event(ByVal&nbsp;bVk&nbsp;As&nbsp;Byte,&nbsp;ByVal&nbsp;bScan&nbsp;As&nbsp;Byte,&nbsp;ByVal&nbsp;dwFlags&nbsp;As&nbsp;Integer,&nbsp;ByVal&nbsp;dwExtraInfo&nbsp;As&nbsp;Integer)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Sub&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;Shared&nbsp;Sub&nbsp;EnterKeyPress(ByVal&nbsp;Key&nbsp;As&nbsp;Integer,&nbsp;ByVal&nbsp;sleept&nbsp;As&nbsp;Integer)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keybd_event(Key,&nbsp;0,&nbsp;0,&nbsp;0)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;按下Enter键&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Threading.Thread.Sleep(sleept)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keybd_event(Key,&nbsp;0,&nbsp;2,&nbsp;0)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;释放Enter键&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Sub&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;Shared&nbsp;Sub&nbsp;EnterKeyDown(ByVal&nbsp;key&nbsp;As&nbsp;Integer)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keybd_event(key,&nbsp;0,&nbsp;0,&nbsp;0)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Sub&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;Shared&nbsp;Sub&nbsp;EnterKeyUp(ByVal&nbsp;key&nbsp;As&nbsp;Integer)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keybd_event(key,&nbsp;0,&nbsp;2,&nbsp;0)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;End&nbsp;Sub&nbsp;&nbsp;</span><br/><span>End&nbsp;Class&nbsp;&nbsp;</span></div><p><span style="color:#FF6600">6.鼠标控制模拟类</span></p><div class="dp-highlighter bg_vb"><span><span class="keyword">Public</span><span>&nbsp;</span><span class="keyword">Class</span><span>&nbsp;MouseControl&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Public</span><span>&nbsp;</span><span class="keyword">Const</span><span>&nbsp;MOUSEEVENTF_LEFTDOWN&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Long</span><span>&nbsp;=&nbsp;&amp;H2&nbsp;</span><span class="comment">&#39;模拟鼠标左键按下</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Public</span><span>&nbsp;</span><span class="keyword">Const</span><span>&nbsp;MOUSEEVENTF_LEFTUP&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Long</span><span>&nbsp;=&nbsp;&amp;H4&nbsp;</span><span class="comment">&#39;模拟鼠标左键释放</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Public</span><span>&nbsp;</span><span class="keyword">Const</span><span>&nbsp;MOUSEEVENTF_MIDDLEDOWN&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Long</span><span>&nbsp;=&nbsp;&amp;H20&nbsp;</span><span class="comment">&#39;模拟鼠标中间键按下</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Public</span><span>&nbsp;</span><span class="keyword">Const</span><span>&nbsp;MOUSEEVENTF_MIDDLEUP&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Long</span><span>&nbsp;=&nbsp;&amp;H40&nbsp;</span><span class="comment">&#39;模拟鼠标中间键释放</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Public</span><span>&nbsp;</span><span class="keyword">Const</span><span>&nbsp;MOUSEEVENTF_RIGHTDOWN&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Long</span><span>&nbsp;=&nbsp;&amp;H8&nbsp;</span><span class="comment">&#39;模拟鼠标右键按下</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Public</span><span>&nbsp;</span><span class="keyword">Const</span><span>&nbsp;MOUSEEVENTF_RIGHTUP&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Long</span><span>&nbsp;=&nbsp;&amp;H10&nbsp;</span><span class="comment">&#39;模拟鼠标右键释放</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Public</span><span>&nbsp;</span><span class="keyword">Const</span><span>&nbsp;MOUSEEVENTF_MOVE&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Long</span><span>&nbsp;=&nbsp;&amp;H1&nbsp;</span><span class="comment">&#39;模拟鼠标指针移动</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Public</span><span>&nbsp;</span><span class="keyword">Const</span><span>&nbsp;MOOSEEVENTF_WHEEL&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Long</span><span>&nbsp;=&nbsp;&amp;H800&nbsp;</span><span class="comment">&#39;模拟鼠标指针移动</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Public</span><span>&nbsp;</span><span class="keyword">Structure</span><span>&nbsp;MousePoint&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Dim</span><span>&nbsp;x&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Integer</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Dim</span><span>&nbsp;y&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Integer</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">End</span><span>&nbsp;</span><span class="keyword">Structure</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Public</span><span>&nbsp;</span><span class="keyword">Declare</span><span>&nbsp;</span><span class="keyword">Function</span><span>&nbsp;SetCursorPos&nbsp;</span><span class="keyword">Lib</span><span>&nbsp;</span><span class="string">&quot;user32&quot;</span><span>&nbsp;(</span><span class="keyword">ByVal</span><span>&nbsp;x&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Integer</span><span>,&nbsp;</span><span class="keyword">ByVal</span><span>&nbsp;y&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Integer</span><span>)&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Integer</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Private</span><span>&nbsp;</span><span class="keyword">Declare</span><span>&nbsp;</span><span class="keyword">Sub</span><span>&nbsp;mouse_event&nbsp;</span><span class="keyword">Lib</span><span>&nbsp;</span><span class="string">&quot;user32&quot;</span><span>&nbsp;(</span><span class="keyword">ByVal</span><span>&nbsp;dwFlags&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Integer</span><span>,&nbsp;</span><span class="keyword">ByVal</span><span>&nbsp;dx&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Integer</span><span>,&nbsp;</span><span class="keyword">ByVal</span><span>&nbsp;dy&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Integer</span><span>,&nbsp;</span><span class="keyword">ByVal</span><span>&nbsp;cButtons&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Integer</span><span>,&nbsp;</span><span class="keyword">ByVal</span><span>&nbsp;dwExtraInfo&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Integer</span><span>)&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Public</span><span>&nbsp;</span><span class="keyword">Declare</span><span>&nbsp;</span><span class="keyword">Function</span><span>&nbsp;GetCursorPos&nbsp;</span><span class="keyword">Lib</span><span>&nbsp;</span><span class="string">&quot;user32&quot;</span><span>&nbsp;</span><span class="keyword">Alias</span><span>&nbsp;</span><span class="string">&quot;GetCursorPos&quot;</span><span>&nbsp;(</span><span class="keyword">ByRef</span><span>&nbsp;lpPoint&nbsp;</span><span class="keyword">As</span><span>&nbsp;MousePoint)&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Integer</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Public</span><span>&nbsp;</span><span class="keyword">Shared</span><span>&nbsp;</span><span class="keyword">Sub</span><span>&nbsp;MouseButtonClick(</span><span class="keyword">ByVal</span><span>&nbsp;buttondown&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Long</span><span>,&nbsp;</span><span class="keyword">ByVal</span><span>&nbsp;buttonup&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Long</span><span>,&nbsp;</span><span class="keyword">ByVal</span><span>&nbsp;sleept&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Integer</span><span>)&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mouse_event(buttondown,&nbsp;0,&nbsp;0,&nbsp;0,&nbsp;0)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Threading.Thread.Sleep(sleept)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mouse_event(buttonup,&nbsp;0,&nbsp;0,&nbsp;0,&nbsp;0)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">End</span><span>&nbsp;</span><span class="keyword">Sub</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Public</span><span>&nbsp;</span><span class="keyword">Shared</span><span>&nbsp;</span><span class="keyword">Sub</span><span>&nbsp;MouseButtonDown(</span><span class="keyword">ByVal</span><span>&nbsp;buttondown&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Long</span><span>)&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mouse_event(buttondown,&nbsp;0,&nbsp;0,&nbsp;0,&nbsp;0)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">End</span><span>&nbsp;</span><span class="keyword">Sub</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Public</span><span>&nbsp;</span><span class="keyword">Shared</span><span>&nbsp;</span><span class="keyword">Sub</span><span>&nbsp;MouseButtonUp(</span><span class="keyword">ByVal</span><span>&nbsp;buttonup&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Long</span><span>)&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mouse_event(buttonup,&nbsp;0,&nbsp;0,&nbsp;0,&nbsp;0)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">End</span><span>&nbsp;</span><span class="keyword">Sub</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Public</span><span>&nbsp;</span><span class="keyword">Shared</span><span>&nbsp;</span><span class="keyword">Sub</span><span>&nbsp;MouseMiddleButtonRow(</span><span class="keyword">ByVal</span><span>&nbsp;upordown&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">String</span><span>,&nbsp;</span><span class="keyword">ByVal</span><span>&nbsp;num&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Integer</span><span>,&nbsp;</span><span class="keyword">ByVal</span><span>&nbsp;sleept&nbsp;</span><span class="keyword">As</span><span>&nbsp;</span><span class="keyword">Integer</span><span>)&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">If</span><span>&nbsp;upordown&nbsp;=&nbsp;</span><span class="string">&quot;up&quot;</span><span>&nbsp;</span><span class="keyword">Then</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mouse_event(MOOSEEVENTF_WHEEL,&nbsp;0,&nbsp;0,&nbsp;-num,&nbsp;0)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Threading.Thread.Sleep(sleept)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">Else</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mouse_event(MOOSEEVENTF_WHEEL,&nbsp;0,&nbsp;0,&nbsp;num,&nbsp;0)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Threading.Thread.Sleep(sleept)&nbsp;&nbsp;</span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">End</span><span>&nbsp;</span><span class="keyword">If</span><span>&nbsp;&nbsp;</span></span><br/><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">End</span><span>&nbsp;</span><span class="keyword">Sub</span><span>&nbsp;&nbsp;</span></span><br/><span><span class="keyword">End</span><span>&nbsp;</span><span class="keyword">Class</span><span>&nbsp; <br/></span></span></div>